



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>嵌入python - Librian中文文檔</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../pdf.css">
    
      <link rel="stylesheet" href="../樣式/css.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#python" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Librian中文文檔" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Librian中文文檔
              </span>
              <span class="md-header-nav__topic">
                嵌入python
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Librian中文文檔" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Librian中文文檔
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../主頁.html" title="主頁" class="md-nav__link">
      主頁
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      第一次使用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        第一次使用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../第一次使用/安裝.html" title="安裝" class="md-nav__link">
      安裝
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      製作galgame
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        製作galgame
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/起步.html" title="起步" class="md-nav__link">
      起步
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/劇本寫法.html" title="劇本寫法" class="md-nav__link">
      劇本寫法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/劇本功能.html" title="劇本功能" class="md-nav__link">
      劇本功能
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/立繪.html" title="立繪" class="md-nav__link">
      立繪
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/客製化你的遊戲.html" title="客製化你的遊戲" class="md-nav__link">
      客製化你的遊戲
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../用戶指南/生成遊戲.html" title="生成遊戲" class="md-nav__link">
      生成遊戲
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      進階
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        進階
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="前言.html" title="前言" class="md-nav__link">
      前言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="畫面的定製.html" title="畫面的定製" class="md-nav__link">
      畫面的定製
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="特效.html" title="特效" class="md-nav__link">
      特效
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        嵌入python
      </label>
    
    <a href="嵌入python.html" title="嵌入python" class="md-nav__link md-nav__link--active">
      嵌入python
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="從簡單的例子開始" class="md-nav__link">
    從簡單的例子開始
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="稍微提升" class="md-nav__link">
    稍微提升
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="難題" class="md-nav__link">
    難題
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="究極" class="md-nav__link">
    究極
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" title="注意" class="md-nav__link">
    注意
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="一些坑" class="md-nav__link">
    一些坑
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="實際的執行順序" class="md-nav__link">
    實際的執行順序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#goto" title="goto在副線程調用時不會立即跳轉" class="md-nav__link">
    goto在副線程調用時不會立即跳轉
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="內置函數參考" class="md-nav__link">
    內置函數參考
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gotocall" title="goto/call" class="md-nav__link">
    goto/call
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion" title="fusion" class="md-nav__link">
    fusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choice" title="choice" class="md-nav__link">
    choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adv_end" title="adv_end" class="md-nav__link">
    adv_end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" title="内置函数的别名" class="md-nav__link">
    内置函数的别名
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="設計回想.html" title="設計回想" class="md-nav__link">
      設計回想
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../接下來要做的/一些遺憾.html" title="一些遺憾" class="md-nav__link">
      一些遺憾
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      關於Librian
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        關於Librian
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../關於Librian/關於Librian.html" title="關於Librian" class="md-nav__link">
      關於Librian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../關於Librian/關於實現.html" title="關於實現" class="md-nav__link">
      關於實現
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="從簡單的例子開始" class="md-nav__link">
    從簡單的例子開始
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="稍微提升" class="md-nav__link">
    稍微提升
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="難題" class="md-nav__link">
    難題
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="究極" class="md-nav__link">
    究極
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" title="注意" class="md-nav__link">
    注意
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="一些坑" class="md-nav__link">
    一些坑
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="實際的執行順序" class="md-nav__link">
    實際的執行順序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#goto" title="goto在副線程調用時不會立即跳轉" class="md-nav__link">
    goto在副線程調用時不會立即跳轉
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" title="內置函數參考" class="md-nav__link">
    內置函數參考
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gotocall" title="goto/call" class="md-nav__link">
    goto/call
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion" title="fusion" class="md-nav__link">
    fusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choice" title="choice" class="md-nav__link">
    choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adv_end" title="adv_end" class="md-nav__link">
    adv_end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" title="内置函数的别名" class="md-nav__link">
    内置函数的别名
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="python">嵌入python</h1>
<p>這一節可能需要用到python。</p>
<p>Librian的嵌入python可以用於實現劇本的邏輯，也可以成爲獨立的擴展功能。<br />
如果你想要完成一個完整的galgame的話，嵌入python應該是必須用到的功能吧。</p>
<p>不過這並不意味着你必須去學習這門編程語言——如果只是簡單的功能的話，看樣例就足夠了。</p>
<h2 id="_1">從簡單的例子開始</h2>
<p><strong>hello world:</strong></p>
<pre><code>潘大爺 「準備好了嗎？」
```
print('hello, world')
```
潘大爺 「你在控制檯窗口上看到剛纔輸出的 hello world 了嗎？」
</code></pre>
<p>如果你看到了hello world說明你已經成爲了python大師<small>(笑)</small>，馬上就可以從這裏畢業了。 <br />
<img alt="hw" src="hw.jpg" /></p>
<p><strong>定義變量:</strong></p>
<pre><code>潘大爺 「試着定義一些變量。」
```
hp=150
hp-=50
print(f'潘大爺還有{hp}點生命值！')
```
潘大爺 「看來我的生命值已經如同風中殘燭了。」
</code></pre>
<p>運行結果: </p>
<pre><code>潘大爺還有100點生命值！
</code></pre>
<p><code>print</code> 只會輸出在控制檯上，最終發佈的遊戲並沒有控制檯，所以這個消息是給開發人員看的。 <br />
如果你把 <code>print</code> 換成 <code>fusion</code> 的話，「潘大爺還有100點生命值」除了會顯示在控制檯上以外，也會顯示在adv畫面中。這種方式顯示的文字和劇本一樣經過編譯——也就是說在前面寫上人名的話就會變成對話。</p>
<p><strong>輸出到adv界面:</strong></p>
<pre><code>潘大爺 「我試試這樣說話……」
```
hp=150
hp-=50
fusion(f'潘大爺 「我還有{hp}點生命值！」')
```
潘大爺 「感覺不錯。」
</code></pre>
<p><img alt="100" src="100.jpg" /> <br />
對了，每一次執行是互相關聯的，因此你可以使用上次的代碼塊留下的變量進行判斷。   </p>
<h2 id="_2">稍微提升</h2>
<p>接下來就是分支跳轉了，之前說了劇本函數 <code>WARP</code> ，接下來介紹通用的 <code>if</code> : </p>
<pre><code>潘大爺 「if真是太棒了。」
```
hp=5
hp=-10
if hp&lt;0:
    print('大爺死了。')
    goto('gameover.play')
```
潘大爺 「看來我還活着。」
</code></pre>
<p>劇本「gameover.play」中的內容: </p>
<pre><code>潘大爺 「騙人的吧？」
```
adv_end()
```
</code></pre>
<p>在潘大爺的生命小於0的時候，跳轉到劇本「gameover.play」。 <br />
在「gameover.play」，潘大爺說出「騙人的吧？」之後，調用 <code>adv_end</code> 結束遊戲。</p>
<h2 id="_3">難題</h2>
<p>提供選擇肢的 <code>choice</code> 函數並不是很好理解。 <br />
<code>choice</code> 在adv演出中提供幾個選項，每一個選項都是一個組，包括一個選項名和一個回調函數。<br />
下面是樣例。  </p>
<pre><code class="python">def f():
    好感度+=1      #英文真難！
choice(
    ('跳到一章',lambda: goto('一章.play')),
    ('跳到二章',lambda: goto('二章.play')),
    ('刷好感度', f )
)
</code></pre>

<p>爲什麼分了三行…… <code>lambda</code> 是什麼玩意……爲什麼單獨定義了函數 <code>f</code> …… <br />
好像對於沒python的小夥伴來說太難了點，要解釋的話甚至還設計到了語句和表達式的關係…… <br />
只是依葫蘆畫瓢的話會比較好嗎，不過搞不清楚什麼時候填 <code>lambda</code> 的話就連依葫蘆畫瓢都做不到了……都是不學習的錯<small>(傲嬌臉)</small>！</p>
<p>如果你覺得這個函數有更簡單的設計方法的話，歡迎在 <a href="../接下來要做的/一些遺憾.html">缺少的功能/一些遺憾</a> 提出寶貴意見。</p>
<p>在 <a href="../用戶指南/劇本功能.html">劇本功能</a> 中說過的 <code>WARP</code>，實際上是 <code>choice</code> 和 <code>push</code> 的語法糖。   </p>
<pre><code>WARP [接受治療,壞結局.play] [放棄治療,好結局.play] [蘿莉治療,一章.play,原點]
</code></pre>

<p>相當於</p>
<pre><code class="python">choice(
    ('接受治療',lambda: call('壞結局.play')),
    ('放棄治療',lambda: call('好結局.play')),
    ('蘿莉治療',lambda: call('一章.play','原點'))
)
</code></pre>

<h2 id="_4">究極</h2>
<p>試着嵌入一個「在副線程進行一段時間的操作並在完成時給出反饋」的劇本。</p>
<pre><code>潘大爺 「点一下来开始大约持续5秒的自動更新！」
```
import threading
def 更新():
    time.sleep(5)   # 连接到你自己的发布地址
    goto(lable='更新完了')
    import 窗口,劇本
    劇本.讀者.步進()
    窗口.更新()
t = threading.Thread(target=更新)
t.setDaemon(True)
t.start()
```
*back
潘大爺 「更新还没有结束，更新完了时无需点击会自动进入下一句。」
```
goto(lable='back')
```
*更新完了
潘大爺 「更新完了。」
</code></pre>
<p>這個我怎麼解釋……  <br />
<small>(話說下次提供一個副線程支持吧)</small></p>
<p>試試RPG打架。</p>
<pre><code>```
from random import randint
def 攻擊(a, b):
    傷害 = int(randint(8, 12) / 10 * a['攻擊力'])
    b['當前生命'] -= 傷害
    fusion(f"{a['名']}攻擊{b['名']}！造成{傷害}點傷害！{b['名']}的生命值{b['當前生命']}/{b['總生命']}。")
def 死亡一指(a, b):
    b['當前生命'] = 0
    fusion(f"{a['名']}對{b['名']}使用死亡一指！{b['名']}的生命值{b['當前生命']}/{b['總生命']}。")
大爺 = {'名': '大爺', '速度': 10, '攻擊力': 30, '當前生命': 100, '總生命': 100}
敵人 = {'名': '敵人', '速度': 5, '攻擊力': 9, '當前生命': 80, '總生命': 80}
```

```
if 大爺['速度'] &gt; 敵人['速度']:
    大爺的回合 = True
    fusion('潘大爺 「智者先攻」')
else:
    大爺的回合 = False
```

*決鬥開始

```
if 大爺的回合:
    choice(
        ('攻擊', lambda: 攻擊(大爺, 敵人)),
        ('死亡一指', lambda: 死亡一指(大爺, 敵人))
    )
else:
    攻擊(敵人, 大爺)
大爺的回合 = not 大爺的回合
```

```
if 敵人['當前生命'] &lt;= 0 or 大爺['當前生命'] &lt;= 0:
    adv_end()
```

```
goto(lable='決鬥開始')
```
</code></pre>
<p><small>(話說死亡一指不是應該把目標旁邊的人殺死嗎<small>(笑)</small>)</small></p>
<h2 id="_5">注意</h2>
<p>這部分python代碼運行在一個相對獨立的環境裏，所以不能調用外部的函數，好處是愉快地定義變量也不會和外部產生名衝突。<br />
當然你可以使用python的黑魔法來使用我的其他函數。 <br />
不過如果你的代碼過長，我建議寫成獨立的python文件，然後 <code>import</code> 。  <br />
此外，費時的操作最好另開一個線程來執行，主線程阻塞的話畫面會停止響應。</p>
<h2 id="_6">一些坑</h2>
<h3 id="_7">實際的執行順序</h3>
<p>每次的py塊總是會執行到底，也就是說 <code>goto</code>, <code>call</code>, <code>fusion</code> 並不是即時的，他們真正的作用只是改變了劇本棧的順序，導致在一個塊中多次調用會产生出乎意料的演出順序。 </p>
<p><small>(我雖然想將讀者的實例改爲遞歸的來解決這個問題，但是卻發現這樣存在一個不能存檔的問題。)</small></p>
<p>舉這樣一個例子:   </p>
<pre><code>```
call('第一章.play')
call('第二章.play')
```
</code></pre>
<p>寫的人的想法是想要先演出第一章，第一章結束之後返回調用點，然後演出第二章。 <br />
但實際上的執行順序是  <code>call('第一章.play')</code>  -&gt; <code>call('第二章.play')</code> -&gt; 演出第二章 -&gt; 演出第一章。</p>
<p>因爲在 <code>call</code> 時候劇本的棧頂被先後壓入了第一章和第二章，成爲 <code>(.., 當前劇本, 第一章, 第二章)</code>，第二章在棧頂導致先演出。</p>
<p>我想過的解決辦法是在每一次 <code>call</code> 的時候直接重建一個讀者實例，然後直接進入這個新實例執行，在這個實例執行完畢之後就可以回到調用點執行之後的語句了……但問題是存檔時只能儲存劇本棧不能儲存調用棧，也就是無法在新劇本執行完畢之後返回調用點。</p>
<p>也就是說，由於這個問題，這個做法暫時只能寫成: </p>
<pre><code>```
call('第一章.play')
```

```
call('第二章.play')
```
</code></pre>
<p>如果你有方法的話，歡迎掃描前面的QRcode……不，這個還是火速聯繫我吧。</p>
<h3 id="goto">goto在副線程調用時不會立即跳轉</h3>
<p><code>goto</code> 實際上並不會改變當前adv畫面，生效的是你之前的點擊。也就是說，定時調用需要再調用一次更新方法。</p>
<h2 id="_8">內置函數參考</h2>
<p>在py/endpy中，這幾個函數是預備了的：</p>
<pre><code class="python">goto(path=None, lable=None)

call(path=None, lable=None)

fusion(s)

choice(c1, c2, c3, ...)

adv_end()
</code></pre>

<h3 id="gotocall">goto/call</h3>
<p><code>goto</code> 跳轉到另一個路徑爲 <code>path</code> 的劇本<small>（默认是自身）</small>的一個躍點的位置。如果躍點 <code>tag</code> 不指定就會跳到開頭。 <br />
<code>push</code> 的功能是 <code>goto</code> 加上目標劇本演出結束後回到調用處。   </p>
<pre><code>goto(path='第9章.play', lable='躍點A')
</code></pre>
<p>在目標文件裏要有對應的躍點。</p>
<pre><code>*躍點A
蘿莉 「喵喵喵。」
……
</code></pre>
<h3 id="fusion">fusion</h3>
<p>將一個字符串編譯後顯示在adv畫面中。</p>
<h3 id="choice">choice</h3>
<p>由選項名和回調函數組成選項。</p>
<h3 id="adv_end">adv_end</h3>
<p>清空劇本棧使得adv演出進入結束狀態。</p>
<h2 id="_9">内置函数的别名</h2>
<p>爲了照顧某些……嗯，看到英文就頭大的開發者，還有狂熱的<ruby>民族主義者<rt>リモちゃん</rt></ruby>，而提供了這樣的名字……   </p>
<ul>
<li><code>goto</code>     =  <code>跳轉</code> </li>
<li><code>call</code>     =  <code>調用</code> </li>
<li><code>choice</code>   =  <code>產生選項</code> </li>
<li><code>adv_end</code>  =  <code>演出終了</code> </li>
<li><code>fusion</code>   =  <code>同化</code>  <small>(沒錯這個不是「融合」而是<ruby>「假魂的同化」<rt>ネフェシャドール・フュージョン</rt></ruby>)</small></li>
</ul>
<p>這樣一來就可以中文編程——</p>
<pre><code>```
生命=99
同化(f'潘大爺 「我還有{生命}點生命值！」')
```
</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="特效.html" title="特效" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                特效
              </span>
            </div>
          </a>
        
        
          <a href="設計回想.html" title="設計回想" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                設計回想
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>